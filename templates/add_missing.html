{% extends "layout.html" %}

{% block content %}
<div class="create-item-container">
    <form action="{{ url_for('add_missing_person') }}" method="post" enctype="multipart/form-data" id="createForm">
        <div class="create-header">
            <div class="header-left">
                <a href="{{ url_for('missing_dashboard') }}" class="back-btn"><i class="fas fa-arrow-left"></i></a>
                <div class="header-title">
                    <span class="breadcrumb-small">Missing DB</span>
                    <h2>Creating Item in Missing DB</h2>
                </div>
            </div>
            <div class="header-right">
                <button type="submit" class="btn-circle-check"><i class="fas fa-check"></i></button>
                <button type="button" class="btn-circle-menu"><i class="fas fa-ellipsis-v"></i></button>
            </div>
        </div>

        <div class="form-content">
            <div class="form-section">
                <label class="section-label">Missing Photo *</label>
                <div class="file-upload-area">
                    <input type="file" id="image" name="image" accept="image/*" required onchange="previewImage(this)">
                    <div class="upload-placeholder" id="imagePreview">
                        <div class="upload-icons">
                            <i class="fas fa-upload"></i>
                            <i class="far fa-folder"></i>
                            <i class="fas fa-link"></i>
                        </div>
                        <span>Drag & Drop a File Here</span>
                    </div>
                </div>
            </div>

            {% for field_name, field_config in form_config.items() if field_config.enabled %}
            <div class="form-section">
                <label class="section-label">
                    {{ field_config.label }}
                    {% if not field_config.required %}<span style="color: #9ca3af; font-weight: normal;">(Optional)</span>{% endif %}
                </label>
                
                {% if field_config.type == 'select' %}
                <div class="select-wrapper">
                    <select name="{{ field_name }}" class="form-input" {% if field_config.required %}required{% endif %}>
                        <option value="" disabled selected>Select {{ field_config.label }}</option>
                        {% for option in field_config.options %}
                        <option value="{{ option }}">{{ option }}</option>
                        {% endfor %}
                    </select>
                    <i class="fas fa-chevron-down"></i>
                </div>
                {% elif field_config.type == 'textarea' %}
                <textarea name="{{ field_name }}" class="form-input" 
                          placeholder="Enter {{ field_config.label }}" 
                          rows="3" style="resize: vertical; min-height: 80px;"
                          {% if field_config.required %}required{% endif %}></textarea>
                {% else %}
                <input type="{{ field_config.type }}" 
                       name="{{ field_name }}" 
                       class="form-input" 
                       placeholder="Enter {{ field_config.label }}"
                       {% if field_config.required %}required{% endif %}
                       {% if field_config.type == 'number' %}min="1" max="120"{% endif %}>
                {% endif %}
            </div>
            {% endfor %}

            <div class="form-section">
                <label class="section-label">Missing Face Embedding</label>
                <div class="embeddings-box">
                    <span class="line-number">1</span>
                    <span class="placeholder-text">Embeddings will be generated automatically...</span>
                </div>
            </div>
        </div>
    </form>
</div>

<script>
function previewImage(input) {
    var preview = document.getElementById('imagePreview');
    if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function(e) {
            preview.style.backgroundImage = 'url(' + e.target.result + ')';
            preview.innerHTML = ''; 
            preview.classList.add('has-image');
        }
        reader.readAsDataURL(input.files[0]);
    }
}
</script>
{% endblock %}
